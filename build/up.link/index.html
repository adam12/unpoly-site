<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name='viewport' content='width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1'>
    <meta name="format-detection" content="telephone=no"> 
    <link href='/images/favicon.png' rel='shortcut icon' type='image/png'>

    <title>Linking to page fragments - Up.js Guide</title>

    <link href="/stylesheets/application.css" rel="stylesheet" type="text/css" />
    <link href='http://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700|Source+Sans+Pro:300,400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">

    <script src="/javascripts/application.js" type="text/javascript"></script>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-8114576-16', 'auto');
      ga('send', 'pageview');
    </script>

  </head>
  <body>

    <div class="layout">

      <div class="layout__head"></div>

      <div class="layout__body">
        <div class="viewport">
          <div class="layout__side">

            <a href="/" class="logo" up-dash="#content" up-transition="cross-fade">
              <img class="logo__glyph" src="/images/logo.gif" alt="" />
              <span class="logo__name">
                Up.js
              </span>
              <span class="logo__alpha">
                Alpha
              </span>
            </a>

            <div class="menu">
                <a href="/up.link" class="menu__item" up-dash="#content" up-transition="cross-fade">
                  Linking to page fragments
                </a>
                <a href="/up.modal" class="menu__item" up-dash="#content" up-transition="cross-fade">
                  Modal dialogs
                </a>
                <a href="/up.popup" class="menu__item" up-dash="#content" up-transition="cross-fade">
                  Pop-up overlays
                </a>
                <a href="/up.motion" class="menu__item" up-dash="#content" up-transition="cross-fade">
                  Animation and transitions
                </a>
                <a href="/up.navigation" class="menu__item" up-dash="#content" up-transition="cross-fade">
                  Fast interaction feedback
                </a>
                <a href="/up.magic" class="menu__item" up-dash="#content" up-transition="cross-fade">
                  Registering behavior and custom elements
                </a>
                <a href="/up.flow" class="menu__item" up-dash="#content" up-transition="cross-fade">
                  Changing page fragments programmatically
                </a>
                <a href="/up.proxy" class="menu__item" up-dash="#content" up-transition="cross-fade">
                  Caching and preloading
                </a>
                <a href="/up.form" class="menu__item" up-dash="#content" up-transition="cross-fade">
                  Forms and controls
                </a>
                <a href="/up.tooltip" class="menu__item" up-dash="#content" up-transition="cross-fade">
                  Tooltips
                </a>
                <a href="/up.slot" class="menu__item" up-dash="#content" up-transition="cross-fade">
                  Content slots
                </a>
                <a href="/up.history" class="menu__item" up-dash="#content" up-transition="cross-fade">
                  Manipulating the browser history
                </a>
                <a href="/up.viewport" class="menu__item" up-dash="#content" up-transition="cross-fade">
                  Viewport scrolling
                </a>
                <a href="/up.bus" class="menu__item" up-dash="#content" up-transition="cross-fade">
                  Framework events
                </a>
            </div>

            <div class="layout__fineprint">
              A <a href="http://www.makandra.com/" class="hyperlink is_gray">makandra</a> project
              (<a href="/imprint" class="hyperlink is_gray" up-dash="#content" up-transition="cross-fade">imprint</a>)
            </div>

          </div>

          <div class="layout__content">
            <div id="content">
              

<h1 class="title">
  Linking to page fragments
</h1>

<div class='prose'>
<p>Just like in a classical web application, an Up.js app renders a series of <em>full HTML pages</em> on the server.</p>

<p>Let's say we are rendering three pages with a tabbed navigation to switch between screens:</p>

<pre><code>  /pages/a                /pages/b                /pages/c

+---+---+---+           +---+---+---+           +---+---+---+
| A | B | C |           | A | B | C |           | A | B | C |
|   +--------  (click)  +---+   +----  (click)  +---+---+   |
|           |  ======&gt;  |           |  ======&gt;  |           |
|  Page A   |           |  Page B   |           |  Page C   |
|           |           |           |           |           |
+-----------|           +-----------|           +-----------|
</code></pre>

<p>Your HTML could look like this:</p>

<pre><code>&lt;nav&gt;
  &lt;a href="/pages/a"&gt;A&lt;/a&gt;
  &lt;a href="/pages/b"&gt;B&lt;/a&gt;
  &lt;a href="/pages/b"&gt;C&lt;/a&gt;
&lt;/nav&gt;

&lt;article&gt;
  Page A
&lt;/article&gt;
</code></pre>

<p>Using this document-oriented way of navigating between pages
is not a good fit for modern applications, for a multitude of reasons:</p>

<ul>
  <li>State changes caused by AJAX updates get lost during the page transition.</li>
  <li>Unsaved form changes get lost during the page transition.</li>
  <li>The Javascript VM is reset during the page transition.</li>
  <li>If the page layout is composed from multiple srollable containers
(e.g. a pane view), the scroll positions get lost during the page transition.</li>
  <li>The user sees a "flash" as the browser loads and renders the new page,
even if large portions of the old and new page are the same (navigation, layout, etc.).</li>
</ul>

<h2 id="smoother-flow-by-updating-fragments">Smoother flow by updating fragments</h2>

<p>In Up.js you annotate navigation links with an <code>up-target</code> attribute.
The value of this attribute is a CSS selector that indicates which page
fragment to update.</p>

<p>Since we only want to update the <code>&lt;article&gt;</code> tag, we will use <code>up-target="article"</code>:</p>

<pre><code>&lt;nav&gt;
  &lt;a href="/pages/a" up-target="article"&gt;A&lt;/a&gt;
  &lt;a href="/pages/b" up-target="article"&gt;B&lt;/a&gt;
  &lt;a href="/pages/b" up-target="article"&gt;C&lt;/a&gt;
&lt;/nav&gt;
</code></pre>

<p>Instead of <code>article</code> you can use any other CSS selector (e. g.  <code>#main .article</code>).</p>

<p>With these <code>up-target</code> annotations Up.js only updates the targeted part of the screen.
Javascript will not be reloaded, no white flash during a full page reload.</p>

<h2 id="read-on">Read on</h2>
<ul>
  <li>You can <a href="/up.motion">animate page transitions</a> by definining animations for fragments as they enter or leave the screen.</li>
  <li>The <code>up-target</code> mechanism also works with <a href="/up.form">forms</a>.</li>
  <li>As you switch through pages, Up.js will <a href="/up.history">update your browser's location bar and history</a></li>
  <li>You can <a href="/up.modal">open fragments in popups or modal dialogs</a>.</li>
  <li>You can give users <a href="/up.navigation">immediate feedback</a> when a link is clicked or becomes current, without waiting for the server.</li>
  <li><a href="/up.flow">Controlling Up.js pragmatically through Javascript</a></li>
  <li><a href="/up.magic">Defining custom tags and event handlers</a></li>
</ul>

</div>

  <div class="api">

    <div class="api__title">Unobtrusive behavior</div>

    <div class="api__explanation">
      Elements matching these CSS selectors will automatically
      gain useful behavior when they are added to the DOM tree.
    </div>

    <div class="api__symbols">

        <div class="symbol is_public" id="a.up-target">

  <div class="symbol__signature">
    <a href="#a.up-target">a[up-target]</a>
  </div>

    <div class="symbol__prose">
      <div class='prose'><p>Follows this link via AJAX and replaces a CSS selector in the current page
with corresponding elements from a new page fetched from the server:</p>

<pre><code>&lt;a href="/posts/5" up-target=".main"&gt;Read post&lt;/a&gt;
</code></pre>

<h4 id="updating-multiple-fragments">Updating multiple fragments</h4>

<p>You can update multiple fragments from a single request by separating
separators with a comma (like in CSS). E.g. if opening a post should
also update a bubble showing the number of unread posts, you might
do this:</p>

<pre><code>&lt;a href="/posts/5" up-target=".main, .unread-count"&gt;Read post&lt;/a&gt;
</code></pre>

<h4 id="appending-or-prepending-instead-of-replacing">Appending or prepending instead of replacing</h4>

<p>By default Up.js will replace the given selector with the same
selector from a freshly fetched page. Instead of replacing you
can <em>append</em> the loaded content to the existing content by using the
<code>:after</code> pseudo selector. In the same fashion, you can use <code>:before</code>
to indicate that you would like the <em>prepend</em> the loaded content.</p>

<p>A practical example would be a paginated list of items. Below the list is
a button to load the next page. You can append to the existing list
by using <code>:after</code> in the <code>up-target</code> selector like this:</p>

<pre><code>&lt;ul class="tasks"&gt;
  &lt;li&gt;Wash car&lt;/li&gt;
  &lt;li&gt;Purchase supplies&lt;/li&gt;
  &lt;li&gt;Fix tent&lt;/li&gt;
&lt;/ul&gt;

&lt;a href="/page/2" class="next-page" up-target=".tasks:after, .next-page"&gt;
  Load more tasks
&lt;/a&gt;
</code></pre>

<h4 id="following-on-mousedown">Following on mousedown</h4>

<p>By also adding an <code>up-instant</code> attribute, the page will be fetched
on <code>mousedown</code> instead of <code>click</code>, making the interaction even faster:</p>

<pre><code>&lt;a href="/users" up-target=".main" up-instant&gt;User list&lt;/a&gt;
</code></pre>

<p>Note that using <code>[up-instant]</code> will prevent a user from canceling a link
click by moving the mouse away from the interaction area. However, for
navigation actions this isn't needed. E.g. popular operation
systems switch tabs on <code>mousedown</code>.</p>

</div>
    </div>



    <div class="symbol__subtitle">
      Parameters
    </div>

      <div class="symbol__param">
        <div class="symbol__param_name">
          up-target          <span class="symbol__type">
            String
          </span>
        </div>
        <div class="symbol__param_prose">
          <div class='prose'><p>The CSS selector to replace</p>
</div>
        </div>
      </div>
      <div class="symbol__param">
        <div class="symbol__param_name">
          up-instant          <span class="symbol__type">
            
          </span>
        </div>
        <div class="symbol__param_prose">
          <div class='prose'><p>If set, fetches the element on <code>mousedown</code> instead of <code>click</code>.
This makes the interaction faster.</p>
</div>
        </div>
      </div>

  
</div>

        <div class="symbol is_public" id="up-follow">

  <div class="symbol__signature">
    <a href="#up-follow">[up-follow]</a>
  </div>

    <div class="symbol__prose">
      <div class='prose'><p>If applied on a link, Follows this link via AJAX and replaces the
current <code>&lt;body&gt;</code> element with the response's <code>&lt;body&gt;</code> element</p>

<pre><code>&lt;a href="/users" up-follow&gt;User list&lt;/a&gt;
</code></pre>

<h4 id="following-on-mousedown">Following on mousedown</h4>

<p>By also adding an <code>up-instant</code> attribute, the page will be fetched
on <code>mousedown</code> instead of <code>click</code>, making the interaction even faster:</p>

<pre><code>&lt;a href="/users" up-follow up-instant&gt;User list&lt;/a&gt;
</code></pre>

<p>Note that using <code>[up-instant]</code> will prevent a user from canceling a link
click by moving the mouse away from the interaction area. However, for
navigation actions this isn't needed. E.g. popular operation
systems switch tabs on <code>mousedown</code>.</p>

<h4 id="enlarging-the-click-area">Enlarging the click area</h4>

<p>You can also apply <code>[up-follow]</code> to any element that contains a link
in order to enlarge the link's click area:</p>

<pre><code>&lt;div class="notification" up-follow&gt;
   Record was saved!
   &lt;a href="/records"&gt;Close&lt;/a&gt;
&lt;/div&gt;
</code></pre>

<p>In the example above, clicking anywhere within <code>.notification</code> element
would follow the <em>Close</em> link.</p>

</div>
    </div>



    <div class="symbol__subtitle">
      Parameters
    </div>

      <div class="symbol__param">
        <div class="symbol__param_name">
          [up-follow]          <span class="symbol__type">
            String
          </span>
            <span class="symbol__tag is_optional">
              optional
            </span>
        </div>
        <div class="symbol__param_prose">
          <div class='prose'>
</div>
        </div>
      </div>
      <div class="symbol__param">
        <div class="symbol__param_name">
          up-instant          <span class="symbol__type">
            
          </span>
        </div>
        <div class="symbol__param_prose">
          <div class='prose'><p>If set, fetches the element on <code>mousedown</code> instead of <code>click</code>.</p>
</div>
        </div>
      </div>

  
</div>

        <div class="symbol is_public" id="up-dash">

  <div class="symbol__signature">
    <a href="#up-dash">[up-dash]</a>
  </div>

    <div class="symbol__prose">
      <div class='prose'><p>Marks up the current link to be followed <em>as fast as possible</em>.
This is done by:</p>

<ul>
  <li><a href="/up.link#up-target">Following the link through AJAX</a> instead of a full page load</li>
  <li><a href="/up.proxy#up-preload">Preloading the link's destination URL</a></li>
  <li><a href="/up.link#up-instant">Triggering the link on <code>mousedown</code></a> instead of on <code>click</code></li>
</ul>

<p>Use <code>up-dash</code> like this:</p>

<pre><code>&lt;a href="/users" up-dash=".main"&gt;User list&lt;/a&gt;
</code></pre>

<p>Note that this is shorthand for:</p>

<pre><code>&lt;a href="/users" up-target=".main" up-instant up-preload&gt;User list&lt;/a&gt;  
</code></pre>

<p>You can also apply <code>[up-dash]</code> to any element that contains a link
in order to enlarge the link's click area:</p>

<pre><code>&lt;div class="notification" up-dash&gt;
   Record was saved!
   &lt;a href="/records" up-dash='.main'&gt;Close&lt;/a&gt;
&lt;/div&gt;
</code></pre>

</div>
    </div>



  
</div>


    </div>

  </div>

  <div class="api">

    <div class="api__title">Javascript methods</div>

    <div class="api__explanation">
      Use these methods to programmatically interact
      with Up.js from your own Javascript code.
    </div>

    <div class="api__symbols">

        <div class="symbol is_public" id="up.visit">

  <div class="symbol__signature">
    <a href="#up.visit">up.visit(url, options)</a>
  </div>

    <div class="symbol__prose">
      <div class='prose'><p>Visits the given URL without a full page load.
This is done by fetching <code>url</code> through an AJAX request
and replacing the current <code>&lt;body&gt;</code> element with the response's <code>&lt;body&gt;</code> element.</p>

<p>For example, this would fetch the <code>/users</code> URL:</p>

<pre><code>up.visit('/users')
</code></pre>

</div>
    </div>



    <div class="symbol__subtitle">
      Parameters
    </div>

      <div class="symbol__param">
        <div class="symbol__param_name">
          url          <span class="symbol__type">
            String
          </span>
        </div>
        <div class="symbol__param_prose">
          <div class='prose'><p>The URL to visit.</p>
</div>
        </div>
      </div>
      <div class="symbol__param">
        <div class="symbol__param_name">
          options          <span class="symbol__type">
            Object
          </span>
        </div>
        <div class="symbol__param_prose">
          <div class='prose'><p>See options for <a href="/up.flow#up.replace"><code>up.replace</code></a></p>
</div>
        </div>
      </div>

  
</div>

        <div class="symbol is_public" id="up.follow">

  <div class="symbol__signature">
    <a href="#up.follow">up.follow(link, [options])</a>
  </div>

    <div class="symbol__prose">
      <div class='prose'><p>Follows the given link via AJAX and replaces a CSS selector in the current page
with corresponding elements from a new page fetched from the server.</p>

<p>Any Up.js UJS attributes on the given link will be honored. E. g. you have this link:</p>

<pre><code>&lt;a href="/users" up-target=".main"&gt;Users&lt;/a&gt;
</code></pre>

<p>You can update the page's <code>.main</code> selector with the <code>.main</code> from <code>/users</code> like this:</p>

<pre><code>var $link = $('a:first'); // select link with jQuery
up.follow($link);
</code></pre>

</div>
    </div>



    <div class="symbol__subtitle">
      Parameters
    </div>

      <div class="symbol__param">
        <div class="symbol__param_name">
          link          <span class="symbol__type">
            Element <span class="symbol__or">or</span> jQuery <span class="symbol__or">or</span> String
          </span>
        </div>
        <div class="symbol__param_prose">
          <div class='prose'><p>An element or selector which resolves to an <code>&lt;a&gt;</code> tag
or any element that is marked up with an <code>up-follow</code> attribute.</p>
</div>
        </div>
      </div>
      <div class="symbol__param">
        <div class="symbol__param_name">
          [options.target]          <span class="symbol__type">
            String
          </span>
            <span class="symbol__tag is_optional">
              optional
            </span>
        </div>
        <div class="symbol__param_prose">
          <div class='prose'>
<p>The selector to replace.
Defaults to the <code>up-target</code> attribute on <code>link</code>,
or to <code>body</code> if such an attribute does not exist.</p>
</div>
        </div>
      </div>
      <div class="symbol__param">
        <div class="symbol__param_name">
          [options.transition]          <span class="symbol__type">
            Function <span class="symbol__or">or</span> String
          </span>
            <span class="symbol__tag is_optional">
              optional
            </span>
        </div>
        <div class="symbol__param_prose">
          <div class='prose'>
<p>A transition function or name.</p>
</div>
        </div>
      </div>
      <div class="symbol__param">
        <div class="symbol__param_name">
          [options.scroll]          <span class="symbol__type">
            Element <span class="symbol__or">or</span> jQuery <span class="symbol__or">or</span> String
          </span>
            <span class="symbol__tag is_optional">
              optional
            </span>
        </div>
        <div class="symbol__param_prose">
          <div class='prose'>
<p>An element or selector that will be scrolled to the top in
case the replaced element is not visible in the viewport.</p>
</div>
        </div>
      </div>
      <div class="symbol__param">
        <div class="symbol__param_name">
          [options.duration]          <span class="symbol__type">
            Number
          </span>
            <span class="symbol__tag is_optional">
              optional
            </span>
        </div>
        <div class="symbol__param_prose">
          <div class='prose'>
<p>The duration of the transition. See <a href="/up.motion#up.morph"><code>up.morph</code></a>.</p>
</div>
        </div>
      </div>
      <div class="symbol__param">
        <div class="symbol__param_name">
          [options.delay]          <span class="symbol__type">
            Number
          </span>
            <span class="symbol__tag is_optional">
              optional
            </span>
        </div>
        <div class="symbol__param_prose">
          <div class='prose'>
<p>The delay before the transition starts. See <a href="/up.motion#up.morph"><code>up.morph</code></a>.</p>
</div>
        </div>
      </div>
      <div class="symbol__param">
        <div class="symbol__param_name">
          [options.easing]          <span class="symbol__type">
            String
          </span>
            <span class="symbol__tag is_optional">
              optional
            </span>
        </div>
        <div class="symbol__param_prose">
          <div class='prose'>
<p>The timing function that controls the transition's acceleration. <a href="/up.motion#up.morph"><code>up.morph</code></a>.</p>
</div>
        </div>
      </div>

  
</div>


    </div>

  </div>

            </div>
          </div>
        </div>
      </div>

    </div>

  </body>
</html>
