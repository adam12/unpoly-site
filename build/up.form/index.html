<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name='viewport' content='width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1'>
    <meta name="format-detection" content="telephone=no"> 
    <link href='/images/favicon.png' rel='shortcut icon' type='image/png'>

    <title>Forms and controls - Up.js Guide</title>

    <link href="/stylesheets/application.css" rel="stylesheet" type="text/css" />
    <link href='http://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700|Source+Sans+Pro:300,400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">

    <script src="/javascripts/application.js" type="text/javascript"></script>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-8114576-16', 'auto');
      ga('send', 'pageview');
    </script>

  </head>
  <body>

    <div class="layout">

      <div class="layout__head"></div>

      <div class="layout__body">
        <div class="viewport">
          <div class="layout__side">

            <a href="/" class="logo" up-dash=".content" up-transition="cross-fade">
              <img class="logo__glyph" src="/images/logo.gif" alt="" />
              <span class="logo__name">
                Up.js
              </span>
              <span class="logo__alpha">
                Alpha
              </span>
            </a>

            <div class="menu">
                <a href="/up.link" class="menu__item" up-dash=".content" up-transition="cross-fade">
                  Linking to page fragments
                </a>
                <a href="/up.modal" class="menu__item" up-dash=".content" up-transition="cross-fade">
                  Modal dialogs
                </a>
                <a href="/up.popup" class="menu__item" up-dash=".content" up-transition="cross-fade">
                  Pop-up overlays
                </a>
                <a href="/up.motion" class="menu__item" up-dash=".content" up-transition="cross-fade">
                  Animation and transitions
                </a>
                <a href="/up.navigation" class="menu__item" up-dash=".content" up-transition="cross-fade">
                  Fast interaction feedback
                </a>
                <a href="/up.magic" class="menu__item" up-dash=".content" up-transition="cross-fade">
                  Registering behavior and custom elements
                </a>
                <a href="/up.flow" class="menu__item" up-dash=".content" up-transition="cross-fade">
                  Changing page fragments programmatically
                </a>
                <a href="/up.proxy" class="menu__item" up-dash=".content" up-transition="cross-fade">
                  Caching and preloading
                </a>
                <a href="/up.form" class="menu__item" up-dash=".content" up-transition="cross-fade">
                  Forms and controls
                </a>
                <a href="/up.tooltip" class="menu__item" up-dash=".content" up-transition="cross-fade">
                  Tooltips
                </a>
                <a href="/up.slot" class="menu__item" up-dash=".content" up-transition="cross-fade">
                  Content slots
                </a>
                <a href="/up.history" class="menu__item" up-dash=".content" up-transition="cross-fade">
                  Manipulating the browser history
                </a>
                <a href="/up.viewport" class="menu__item" up-dash=".content" up-transition="cross-fade">
                  Viewport scrolling
                </a>
                <a href="/up.bus" class="menu__item" up-dash=".content" up-transition="cross-fade">
                  Framework events
                </a>
            </div>

            <div class="layout__fineprint">
              A <a href="http://www.makandra.com/" class="hyperlink is_gray">makandra</a> project
              (<a href="/imprint" class="hyperlink is_gray" up-dash=".content" up-transition="cross-fade">imprint</a>)
            </div>

          </div>

          <div class="layout__content">
            <div class="content">
              

<h1 class="title">
  Forms and controls
</h1>

<div class='prose'>
<p>Up.js comes with functionality to submit forms without
leaving the current page. This means you can replace page fragments,
open dialogs with sub-forms, etc. all without losing form state.</p>

<h3 id="incomplete-documentation">Incomplete documentation!</h3>

<p>We need to work on this page:</p>

<ul>
  <li>Explain how to display form errors</li>
  <li>Explain that the server needs to send 2xx or 5xx status codes so
Up.js can decide whether the form submission was successful</li>
  <li>Explain that the server needs to send <code>X-Up-Location</code> and <code>X-Up-Method</code> headers
if an successful form submission resulted in a redirect</li>
  <li>Examples</li>
</ul>

</div>

  <div class="api">

    <div class="api__title">Unobtrusive behavior</div>

    <div class="api__explanation">
      Elements matching these CSS selectors will automatically
      gain useful behavior when they are added to the DOM tree.
    </div>

    <div class="api__symbols">

        <div class="symbol is_public" id="form.up-target">

  <div class="symbol__signature">
    <a href="#form.up-target">form[up-target]</a>
  </div>

    <div class="symbol__prose">
      <div class='prose'><p>Submits the form through AJAX, searches the response for the selector
given in <code>up-target</code> and replaces the selector content in the current page:</p>

<pre><code>&lt;form method="post" action="/users" up-target=".main"&gt;
  ...
&lt;/form&gt;
</code></pre>

</div>
    </div>



    <div class="symbol__subtitle">
      Parameters
    </div>

      <div class="symbol__param">
        <div class="symbol__param_name">
          up-target          <span class="symbol__type">
            String
          </span>
        </div>
        <div class="symbol__param_prose">
          <div class='prose'><p>The selector to replace if the form submission is successful (200 status code).</p>
</div>
        </div>
      </div>
      <div class="symbol__param">
        <div class="symbol__param_name">
          [up-fail-target]          <span class="symbol__type">
            String
          </span>
            <span class="symbol__tag is_optional">
              optional
            </span>
        </div>
        <div class="symbol__param_prose">
          <div class='prose'>
</div>
        </div>
      </div>
      <div class="symbol__param">
        <div class="symbol__param_name">
          [up-transition]          <span class="symbol__type">
            String
          </span>
            <span class="symbol__tag is_optional">
              optional
            </span>
        </div>
        <div class="symbol__param_prose">
          <div class='prose'>
</div>
        </div>
      </div>
      <div class="symbol__param">
        <div class="symbol__param_name">
          [up-fail-transition]          <span class="symbol__type">
            String
          </span>
            <span class="symbol__tag is_optional">
              optional
            </span>
        </div>
        <div class="symbol__param_prose">
          <div class='prose'>
</div>
        </div>
      </div>
      <div class="symbol__param">
        <div class="symbol__param_name">
          [up-history]          <span class="symbol__type">
            String
          </span>
            <span class="symbol__tag is_optional">
              optional
            </span>
        </div>
        <div class="symbol__param_prose">
          <div class='prose'>
</div>
        </div>
      </div>
      <div class="symbol__param">
        <div class="symbol__param_name">
          [up-method]          <span class="symbol__type">
            String
          </span>
            <span class="symbol__tag is_optional">
              optional
            </span>
        </div>
        <div class="symbol__param_prose">
          <div class='prose'>
<p>The HTTP method to be used to submit the form (<code>get</code>, <code>post</code>, <code>put</code>, <code>delete</code>, <code>patch</code>).
Alternately you can use an attribute <code>data-method</code>
(<a href="https://github.com/rails/jquery-ujs/wiki/Unobtrusive-scripting-support-for-jQuery">Rails UJS</a>)
or <code>method</code> (vanilla HTML) for the same purpose.  </p>
</div>
        </div>
      </div>

  
</div>

        <div class="symbol is_public" id="input.up-observe">

  <div class="symbol__signature">
    <a href="#input.up-observe">input[up-observe]</a>
  </div>

    <div class="symbol__prose">
      <div class='prose'><p>Observes this form field and runs the given script
when its value changes. This is useful for observing text fields
while the user is typing.</p>

<p>For instance, the following would submit the form whenever the
text field value changes:</p>

<pre><code>&lt;form method="GET" action="/search"&gt;
  &lt;input type="query" up-observe="up.form.submit(this)"&gt;
&lt;/form&gt;
</code></pre>

<p>The script given with <code>up-observe</code> runs with the following context:</p>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>value</code></td>
      <td><code>String</code></td>
      <td>The current value of the field</td>
    </tr>
    <tr>
      <td><code>this</code></td>
      <td><code>Element</code></td>
      <td>The form field</td>
    </tr>
    <tr>
      <td><code>$field</code></td>
      <td><code>jQuery</code></td>
      <td>The form field as a jQuery collection</td>
    </tr>
  </tbody>
</table>

<p>See up.observe.</p>

<p>The code to run when the field's value changes.</p>

</div>
    </div>



    <div class="symbol__subtitle">
      Parameters
    </div>

      <div class="symbol__param">
        <div class="symbol__param_name">
          up-observe          <span class="symbol__type">
            String
          </span>
        </div>
        <div class="symbol__param_prose">
          <div class='prose'>
</div>
        </div>
      </div>

  
</div>


    </div>

  </div>

  <div class="api">

    <div class="api__title">Javascript methods</div>

    <div class="api__explanation">
      Use these methods to programmatically interact
      with Up.js from your own Javascript code.
    </div>

    <div class="api__symbols">

        <div class="symbol is_public" id="up.submit">

  <div class="symbol__signature">
    <a href="#up.submit">up.submit(formOrSelector, [options])</a>
  </div>

    <div class="symbol__prose">
      <div class='prose'><p>Submits a form using the Up.js flow:</p>

<pre><code>up.submit('form.new_user')
</code></pre>

<p>Instead of loading a new page, the form is submitted via AJAX.
The response is parsed for a CSS selector and the matching elements will
replace corresponding elements on the current page.</p>

</div>
    </div>



    <div class="symbol__subtitle">
      Parameters
    </div>

      <div class="symbol__param">
        <div class="symbol__param_name">
          formOrSelector          <span class="symbol__type">
            Element <span class="symbol__or">or</span> jQuery <span class="symbol__or">or</span> String
          </span>
        </div>
        <div class="symbol__param_prose">
          <div class='prose'><p>A reference or selector for the form to submit.
If the argument points to an element that is not a form,
Up.js will search its ancestors for the closest form.</p>
</div>
        </div>
      </div>
      <div class="symbol__param">
        <div class="symbol__param_name">
          [options.url]          <span class="symbol__type">
            String
          </span>
            <span class="symbol__tag is_optional">
              optional
            </span>
        </div>
        <div class="symbol__param_prose">
          <div class='prose'>
<p>The URL where to submit the form.
Defaults to the form's <code>action</code> attribute, or to the current URL of the browser window.</p>
</div>
        </div>
      </div>
      <div class="symbol__param">
        <div class="symbol__param_name">
          [options.method]          <span class="symbol__type">
            String
          </span>
            <span class="symbol__tag is_optional">
              optional
            </span>
        </div>
        <div class="symbol__param_prose">
          <div class='prose'>
<p>The HTTP method used for the form submission.
Defaults to the form's <code>up-method</code>, <code>data-method</code> or <code>method</code> attribute, or to <code>'post'</code>
if none of these attributes are given.</p>
</div>
        </div>
      </div>
      <div class="symbol__param">
        <div class="symbol__param_name">
          [options.target]          <span class="symbol__type">
            String
          </span>
            <span class="symbol__tag is_optional">
              optional
            </span>
        </div>
        <div class="symbol__param_prose">
          <div class='prose'>
<p>The selector to update when the form submission succeeds (server responds with status 200).
Defaults to the form's <code>up-target</code> attribute, or to <code>'body'</code>.</p>
</div>
        </div>
      </div>
      <div class="symbol__param">
        <div class="symbol__param_name">
          [options.failTarget]          <span class="symbol__type">
            String
          </span>
            <span class="symbol__tag is_optional">
              optional
            </span>
        </div>
        <div class="symbol__param_prose">
          <div class='prose'>
<p>The selector to update when the form submission fails (server responds with non-200 status).
Defaults to the form's <code>up-fail-target</code> attribute, or to an auto-generated
selector that matches the form itself.</p>
</div>
        </div>
      </div>
      <div class="symbol__param">
        <div class="symbol__param_name">
          [options.history=true]          <span class="symbol__type">
            Boolean <span class="symbol__or">or</span> String
          </span>
            <span class="symbol__tag is_optional">
              optional
            </span>
        </div>
        <div class="symbol__param_prose">
          <div class='prose'>
<p>Successful form submissions will add a history entry and change the browser's
location bar if the form either uses the <code>GET</code> method or the response redirected
to another page (this requires the <code>upjs-rails</code> gem).
If want to prevent history changes in any case, set this to <code>false</code>.
If you pass a <code>String</code>, it is used as the URL for the browser history.</p>
</div>
        </div>
      </div>
      <div class="symbol__param">
        <div class="symbol__param_name">
          [options.transition='none']          <span class="symbol__type">
            String
          </span>
            <span class="symbol__tag is_optional">
              optional
            </span>
        </div>
        <div class="symbol__param_prose">
          <div class='prose'>
<p>The transition to use when a successful form submission updates the <code>options.target</code> selector.
Defaults to the form's <code>up-transition</code> attribute, or to <code>'none'</code>.</p>
</div>
        </div>
      </div>
      <div class="symbol__param">
        <div class="symbol__param_name">
          [options.failTransition='none']          <span class="symbol__type">
            String
          </span>
            <span class="symbol__tag is_optional">
              optional
            </span>
        </div>
        <div class="symbol__param_prose">
          <div class='prose'>
<p>The transition to use when a failed form submission updates the <code>options.failTarget</code> selector.
Defaults to the form's <code>up-fail-transition</code> attribute, or to <code>options.transition</code>, or to <code>'none'</code>.</p>
</div>
        </div>
      </div>
      <div class="symbol__param">
        <div class="symbol__param_name">
          [options.duration]          <span class="symbol__type">
            Number
          </span>
            <span class="symbol__tag is_optional">
              optional
            </span>
        </div>
        <div class="symbol__param_prose">
          <div class='prose'>
<p>The duration of the transition. See <a href="/up.motion#up.morph"><code>up.morph</code></a>.</p>
</div>
        </div>
      </div>
      <div class="symbol__param">
        <div class="symbol__param_name">
          [options.delay]          <span class="symbol__type">
            Number
          </span>
            <span class="symbol__tag is_optional">
              optional
            </span>
        </div>
        <div class="symbol__param_prose">
          <div class='prose'>
<p>The delay before the transition starts. See <a href="/up.motion#up.morph"><code>up.morph</code></a>.</p>
</div>
        </div>
      </div>
      <div class="symbol__param">
        <div class="symbol__param_name">
          [options.easing]          <span class="symbol__type">
            String
          </span>
            <span class="symbol__tag is_optional">
              optional
            </span>
        </div>
        <div class="symbol__param_prose">
          <div class='prose'>
<p>The timing function that controls the transition's acceleration. <a href="/up.motion#up.morph"><code>up.morph</code></a>.</p>
</div>
        </div>
      </div>
      <div class="symbol__param">
        <div class="symbol__param_name">
          [options.cache]          <span class="symbol__type">
            Boolean
          </span>
            <span class="symbol__tag is_optional">
              optional
            </span>
        </div>
        <div class="symbol__param_prose">
          <div class='prose'>
<p>Whether to accept a cached response.</p>
</div>
        </div>
      </div>


    <div class="symbol__subtitle">
      Return value
    </div>

      <div class="symbol__type">
        Promise
      </div>

    <div class="symbol__param_prose">
      <div class='prose'>
<p>A promise for the AJAX response</p>
</div>
    </div>
  
</div>

        <div class="symbol is_public" id="up.observe">

  <div class="symbol__signature">
    <a href="#up.observe">up.observe(fieldOrSelector, options)</a>
  </div>

    <div class="symbol__prose">
      <div class='prose'><p>Observes a form field and runs a callback when its value changes.
This is useful for observing text fields while the user is typing.</p>

<p>For instance, the following would submit the form whenever the
text field value changes:</p>

<pre><code>up.observe('input', { change: function(value, $input) {
  up.submit($input)
} });
</code></pre>

<h4 id="preventing-concurrency">Preventing concurrency</h4>

<p>Firing asynchronous code after a form field can cause
<a href="https://makandracards.com/makandra/961-concurrency-issues-with-find-as-you-type-boxes">concurrency issues</a>.</p>

<p>To mitigate this, <code>up.observe</code> will try to never run a callback
before the previous callback has completed.
To take advantage of this, your callback code must return a promise.
Note that all asynchronous Up.js functions return promises.</p>

<h4 id="throttling">Throttling</h4>

<p>If you are concerned about fast typists causing too much
load on your server, you can use a <code>delay</code> option to wait before
executing the callback:</p>

<pre><code>up.observe('input', {
  delay: 100,
  change: function(value, $input) { up.submit($input) }
});
</code></pre>

</div>
    </div>



    <div class="symbol__subtitle">
      Parameters
    </div>

      <div class="symbol__param">
        <div class="symbol__param_name">
          fieldOrSelector          <span class="symbol__type">
            Element <span class="symbol__or">or</span> jQuery <span class="symbol__or">or</span> String
          </span>
        </div>
        <div class="symbol__param_prose">
          <div class='prose'>
</div>
        </div>
      </div>
      <div class="symbol__param">
        <div class="symbol__param_name">
          options.change          <span class="symbol__type">
            Function(value, $field) <span class="symbol__or">or</span> String
          </span>
        </div>
        <div class="symbol__param_prose">
          <div class='prose'><p>The callback to execute when the field's value changes.
If given as a function, it must take two arguments (<code>value</code>, <code>$field</code>).
If given as a string, it will be evaled as Javascript code in a context where
(<code>value</code>, <code>$field</code>) are set.</p>
</div>
        </div>
      </div>
      <div class="symbol__param">
        <div class="symbol__param_name">
          [options.delay=0]          <span class="symbol__type">
            Number
          </span>
            <span class="symbol__tag is_optional">
              optional
            </span>
        </div>
        <div class="symbol__param_prose">
          <div class='prose'>
<p>The number of miliseconds to wait before executing the callback
after the input value changes. Use this to limit how often the callback
will be invoked for a fast typist.</p>
</div>
        </div>
      </div>

  
</div>


    </div>

  </div>

            </div>
          </div>
        </div>
      </div>

    </div>

  </body>
</html>
